<!DOCTYPE html>
<html lang="en" xmlns:sec="http://www.w3.org/1999/xhtml" xmlns:th="http://www.w3.org/1999/xhtml"
      xmlns:v-bind="http://www.w3.org/1999/xhtml" xmlns:v-on="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="UTF-8">
    <title>Заявки</title>

    <th:block th:include="fragments/header :: scripts"></th:block>
    <script src="/media/DataTables/numeric-plugin.js"></script>
    <!--<script src="/media/vue.min.js"></script>-->
    <script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
    <script sec:authorize='hasAnyAuthority("ROLE_ADMIN","ROLE_DISPATCHER")' src="/orders/js/all-orders.js"></script>
    <script sec:authorize='hasAnyAuthority("ROLE_ADMIN","ROLE_DISPATCHER")'
            src="/orders/js/orders-in-work-dispatcher.js"></script>
    <script src="/orders/js/all-companies-dispatcher.js"
            sec:authorize='hasAnyAuthority("ROLE_DISPATCHER")'></script>
    <script src="/orders/js/all-companies-admin.js"
            sec:authorize='hasAnyAuthority("ROLE_ADMIN")'></script>
    <script sec:authorize='hasAnyAuthority("ROLE_ADMIN","ROLE_DISPATCHER")'
            src="/main/js/dispatcher/points.js"></script>
    <script sec:authorize='hasAnyAuthority("ROLE_ADMIN","ROLE_DISPATCHER")'
            src="/main/js/dispatcher/routes.js"></script>
    <script sec:authorize='hasAnyAuthority("ROLE_ADMIN","ROLE_DISPATCHER")'
            src="/main/js/dispatcher/contacts.js"></script>
    <script sec:authorize='hasAnyAuthority("ROLE_ADMIN","ROLE_DISPATCHER")'
            src="/main/js/dispatcher/clients.js"></script>
    <script sec:authorize='hasAnyAuthority("ROLE_TRANSPORT_COMPANY")'
            src="/orders/js/orders-in-work-company.js"></script>
    <script sec:authorize='hasAnyAuthority("ROLE_TRANSPORT_COMPANY")'
            src="/main/js/company/dispatched-offers.js"></script>
    <script src="/main/js/listSearch.js" type="text/javascript"></script>
    <script src="http://api-maps.yandex.ru/2.1/?lang=ru-RU" type="text/javascript"></script>
    <script src="/media/jquery.ba-throttle-debounce.min.js"></script>
</head>
<body class="grey">
<div th:insert="fragments/header :: header('orders')"></div>

<nav class="logist-tabs">
    <div>
        <ul class="ml-md-auto flex-row nav container nav-fill" role="tablist">
            <li id="tab-all-orders-link" class="nav-item"
                sec:authorize='hasAnyAuthority("ROLE_ADMIN","ROLE_DISPATCHER")'>
                <a class="nav-link active" data-toggle="tab" aria-selected="false" href="#tab-all-orders"><i
                        class="fa fa-" aria-hidden="true"></i> Все заявки</a>
            </li>

            <li id="tab-pending-orders-link" class="nav-item" sec:authorize="hasAuthority('ROLE_TRANSPORT_COMPANY')">
                <a class="nav-link" data-toggle="tab" aria-selected="false" href="#tab-pending-orders"><span
                        class="badge badge-light" th:if="${pendingOrders!=null && #lists.size(pendingOrders) > 0}"
                        th:text="${#lists.size(pendingOrders)}"></span>
                    <i class="fa fa-th-list" aria-hidden="true"></i> Предложенные заявки
                </a>
            </li>
            <li id="tab-dispatched-offers-link" class="nav-item" sec:authorize="hasAuthority('ROLE_TRANSPORT_COMPANY')">
                <a class="nav-link" data-toggle="tab" aria-selected="false" href="#tab-dispatched-offers">
                    Высланные предложения
                </a>
            </li>
            <li id="tab-managed-offers-link" class="nav-item" sec:authorize="hasAuthority('ROLE_DISPATCHER')">
                <a class="nav-link" data-toggle="tab" aria-selected="false" href="#tab-managed-offers">
                    <span class="badge badge-primary" th:if="${managedOffers!=null && #lists.size(managedOffers) > 0}"
                          th:text="${#lists.size(managedOffers)}"></span>
                    <i class="fa fa-wpforms" aria-hidden="true"></i> Предложения
                </a>
            </li>
            <li id="tab-orders-in-work-link" class="nav-item">
                <a class="nav-link" data-toggle="tab" aria-selected="false" href="#tab-orders-in-work">
                    <i class="fa fa-truck" aria-hidden="true"></i>
                    Заявки в работе
                </a>
            </li>
            <li class="nav-item" sec:authorize="hasAnyAuthority('ROLE_DISPATCHER')">
                <a class="nav-link" data-toggle="tab" aria-selected="false" href="#tab-orders-map">
                    <i class="fa fa-map" aria-hidden="true"></i> На карте
                </a>
            </li>
            <li id="tab-routes-link" class="nav-item" sec:authorize='hasAnyAuthority("ROLE_ADMIN","ROLE_DISPATCHER")'>
                <a class="nav-link" data-toggle="tab" aria-selected="true" href="#tab-routes"><i
                        class="fa fa-compass" aria-hidden="true"></i> Маршруты</a></li>
            <li id="tab-contacts-link" class="nav-item" sec:authorize='hasAnyAuthority("ROLE_ADMIN","ROLE_DISPATCHER")'>
                <a class="nav-link" data-toggle="tab" aria-selected="false" href="#tab-contacts">
                    <i class="fa fa-address-book" aria-hidden="true"></i>
                    Клиенты
                </a>
            </li>
            <li id="tab-companies-link" class="nav-item"
                sec:authorize='hasAnyAuthority("ROLE_ADMIN","ROLE_DISPATCHER")'>
                <a class="nav-link" data-toggle="tab" aria-selected="false" href="#tab-companies">
                    <i class="fa fa-truck" aria-hidden="true"></i>
                    Перевозчики
                </a>
            </li>


        </ul>
    </div>
</nav>
<div class="modal" id="orderDocumentUploadModal" tabindex="-1" role="dialog">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Загрузить документ</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <form id="orderDocumentUploadForm">

                    <input id="orderIdInput" name="id" hidden>
                    <div class="row">
                        <div class="col-4">Название файла<sup class="red">*</sup></div>
                        <div class="col-8"><input class="form-control" type="text" name="fileName"></div>
                    </div>
                    <br>
                    <div class="row">
                        <div class="col-4">Файл<sup class="red">*</sup></div>
                        <div class="col-8"><input type="file" name="file"></div>
                    </div>

                    <div class="red" id="orderDocumentUploadError">
                    </div>

                </form>
            </div>
            <div class="modal-footer">
                <button id="uploadOrderDocument" class="btn btn-primary">Загрузить</button>
            </div>
        </div>
    </div>
</div>
<div class="modal" id="contractUploadModal" tabindex="-1" role="dialog">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Загрузить договор</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <form id="contractUploadForm">

                    <input id="companyIdInput" name="id" hidden>
                    <div class="row">
                        <div class="col-4">Название договора<sup class="red">*</sup></div>
                        <div class="col-8"><input class="form-control" type="text" name="fileName"></div>
                    </div>
                    <br>
                    <div class="row">
                        <div class="col-4">Файл<sup class="red">*</sup></div>
                        <div class="col-8"><input type="file" name="file"></div>
                    </div>
                    <div class="red" id="contractUploadError">
                    </div>

                </form>
            </div>
            <div class="modal-footer">
                <button id="uploadContract" class="btn btn-primary">Загрузить</button>
            </div>
        </div>
    </div>
</div>

<div class="tab-content" id="tabContent">
    <div id="tab-all-orders"
         th:classappend="(${#authorization.expression('hasRole(''ROLE_TRANSPORT_COMPANY'')')})? '' : 'in active' "
         class="tab-pane">
        <div class="spaced-container white container-fluid" style="overflow-x: scroll">
            <h4>Все заявки</h4>
            <div>
                <table class="table table-sm table-striped " id="orderTable">
                    <thead>
                    <tr>
                        <th>id</th>
                        <th>Номер</th>
                        <th>Статус</th>
                        <th>Предложения</th>
                        <th>Маршрут</th>
                        <th>ТК</th>
                        <th>Транспорт</th>
                        <th>Водитель</th>
                        <th>Требования</th>
                        <th>Груз</th>
                        <th>Описание груза</th>
                        <th>Вес груза</th>
                        <th>Объем груза</th>
                        <th>Кол-во паллет</th>
                        <th>Размеры груза</th>
                        <th>Догруз</th>
                        <th>Дни для оплаты</th>
                        <th>Дни для возврата<br>документов</th>
                        <th>Рейтинг</th>
                        <th>Обязательность</th>
                        <th>Оплата</th>
                        <th>Дата исполнения</th>
                    </tr>
                    </thead>
                </table>
            </div>
        </div>
    </div>
    <div id="tab-orders-map"
         class="tab-pane">
        <div class="spaced-container white container-fluid">
            <h4>Заявки на карте</h4>
            <div class="row" id="ordersInWorkMap">
                <div class="col-3">
                    <!--<div class="input-group">-->
                        <!--<input  class="form-control">-->
                        <!--<div class="input-group-append">-->
                            <!--<span class="input-group-text"><i class="fa fa-search"></i></span>-->
                        <!--</div>-->
                    <!--</div>-->
                    <div class="list-group">

                        <a href="#" v-for="order in orders" @click="loadOrderInfo(order.id)"
                           class="list-group-item list-group-item-action">
                            {{ order.number }}
                            <small>
                                <div class="row">
                                    <div class="col-6">
                                        {{order.status}}
                                    </div>
                                    <div class="col-6">
                                        Дата отправки: {{order.dispatchDate}}
                                    </div>
                                </div>
                            </small>
                        </a>
                        <nav aria-label="Page navigation example">
                            <ul class="pagination" v-if="pageRange">
                                <li class="page-item" v-if="previous"><a class="page-link"  @click="previousPage()" href="#"><i class="fa fa-arrow-left"></i></a></li>
                                <li class="page-item" v-for="page in pageRange" :key="page" v-bind:class="{active : (page==pageNumber)}">
                                    <span class="page-link" @click="loadPage(page)" href="#">{{page+1}}</span>
                                </li>
                                <li class="page-item" v-if="next"><a class="page-link" @click="nextPage()" href="#"><i class="fa fa-arrow-right"></i></a></li>
                            </ul>
                        </nav>
                    </div>

                </div>
                <div class="col-5" style="min-height: 500px">
                    <div style="width: 100%; height:100%; max-height: 600px;" id="orderMap"></div>
                </div>
                <div class="col-4">
                    <!--<small class="text-muted">Здесь будет инфо о заявке</small>-->
                    <div class="row" v-if="orderInfo">
                        <div class="col-12">
                            <h5>{{orderInfo.order.number}}<br>
                                <small class="text-muted">{{orderInfo.order.status}}</small>
                            </h5>
                        </div>
                        <div class="col-6">
                            <div>
                                Маршрут: {{orderInfo.order.route.name}}
                                Пункты маршрута:
                                <ol>
                                    <li v-for="routePoint in orderInfo.order.route.routePoints">
                                        {{routePoint.point.name}}<br>
                                        <small class="text-muted">{{routePoint.point.address}}</small>
                                    </li>
                                </ol>
                            </div>
                            <div v-if="orderInfo.order.company">
                                Перевозчик: {{orderInfo.order.company.name}}<br>
                                <span v-if="orderInfo.order.driver">Водитель: {{orderInfo.order.driver.name}}<br></span>
                                <span v-if="orderInfo.order.transport">Транспорт: {{orderInfo.order.transport.number}}<br></span>
                            </div>
                        </div>
                        <div class="col-6">
                            <div>
                                Груз:
                                <ul>
                                    <li v-for="cargoUnit in orderInfo.order.cargo">
                                        {{cargoUnit}}
                                    </li>
                                </ul>
                                Требования:
                                <ul>
                                    <li v-for="requirement in orderInfo.order.requirements">
                                        {{requirement}}
                                    </li>
                                </ul>
                            </div>
                        </div>
                    </div>
                    <!--<div class="list-group">-->
                    <!--<div class="input-group">-->
                    <!--<input class="form-control">-->
                    <!--<div class="input-group-append">-->
                    <!--<span class="input-group-text"><i class="fa fa-search"></i></span>-->
                    <!--</div>-->
                    <!--</div>-->
                    <!--<a href="#" v-for="order in orders" @click="loadOrderInfo(order.id)"-->
                    <!--class="list-group-item list-group-item-action">-->
                    <!--{{ order.number }}-->
                    <!--<small>-->
                    <!--<div class="row">-->
                    <!--<div class="col-6">-->
                    <!--Статус: {{order.status}}-->
                    <!--</div>-->
                    <!--<div class="col-6">-->
                    <!--Дата отправки: {{order.dispatchDate}}-->
                    <!--</div>-->
                    <!--</div>-->
                    <!--</small>-->
                    <!--</a>-->
                    <!--</div>-->
                </div>

            </div>
        </div>
    </div>
    <div id="tab-pending-orders"
         th:classappend="(${#authorization.expression('hasRole(''ROLE_TRANSPORT_COMPANY'')')})? 'in active' : '' "
         class="tab-pane">
        <div class="spaced-container white container-fluid">
            <h4>Предложенные заявки</h4>
            <div class="row" id="pendingOrders">
                <div class="col-2">
                    <h5 th:if="${pendingOrders==null || #lists.size(pendingOrders) == 0}">
                        <small class="text-muted">Предложенные заявки появятся здесь.</small>
                    </h5>
                    <div class="list-group">
                        <div class="input-group">
                            <input class="form-control">
                            <div class="input-group-append">
                                <span class="input-group-text"><i class="fa fa-search"></i></span>
                            </div>
                        </div>
                        <a href="#" v-for="pendingOrder in pendingOrders" @click="loadOrderInfo(pendingOrder.id)"
                           v-bind:class="getOrderColor(pendingOrder.isMandatory)"
                           class="list-group-item list-group-item-action">
                            {{ pendingOrder.number }}
                        </a>
                    </div>
                </div>
                <div class="col-7" id="pendingOrderInfo">
                    <h5 v-if="order" class="red-first-letter">{{order.number}}</h5>
                    <div class="row" v-if="order">
                        <div class="col-4">
                            Маршрут:<br>
                            {{order.route.name}}<br>
                            <br>
                            Дата оплаты:<br>
                            {{order.paymentDate}}<br><br>

                            Требования:
                            <ul>
                                <li v-for="requirement in order.requirements">{{requirement}}</li>
                            </ul>
                            <br>
                        </div>
                        <div class="col-4">
                            Обязательность:<br>{{order.orderObligation}}<br><br>
                            Дата возврата документов:<br>
                            {{order.documentReturnDate}} <br><br>
                            Груз:
                            <ul>
                                <li v-for="cargoUnit in order.cargo">{{cargoUnit}}</li>
                            </ul>
                            {{order.cargoDescription}}
                            <div v-if="order.cargoWeight && order.cargoVolume" class="row">

                                <div class="col">
                                    <br>
                                    Вес:
                                    {{order.cargoWeight}}кг
                                </div>
                                <div class="col">
                                    <br>
                                    Объем:
                                    {{order.cargoVolume}}м<sup>3</sup>
                                </div>
                            </div>
                            <div v-if="order.cargoHeight && order.cargoWidth && order.cargoLength">
                                <br>Размер:<br>
                                {{order.cargoHeight}}м x {{order.cargoWidth}}м х {{order.cargoLength}}м
                            </div>
                        </div>
                        <div class="col-4">

                            Пункты:
                            <div class="row" v-for="routePoint in order.route.routePoints">
                                <div class="col-4">
                                    {{routePoint.queueNumber==0 ? 'Склад отправки' : ('Разгрузка '+routePoint.queueNumber)}}

                                </div>
                                <div class="col-6">
                                    {{routePoint.point.name}}
                                    {{routePoint.point.address}}
                                </div>
                            </div>
                            Дата исполнения:<br>
                            {{order.dispatchDate}}
                        </div>
                    </div>
                </div>
                <div class="col-3" id="pendingOrderAcceptForm" :hidden="(order==null)">
                    <div class="form-group">
                        <label for="orderTransportSelect">Транспорт</label>
                        <input id="orderTransportSelect">

                    </div>
                    <div class="form-group">
                        <label for="orderDriverSelect">Водитель</label>
                        <input id="orderDriverSelect">

                    </div>
                    <div class="form-group">
                        <label for="orderProposedPrice">Стоимость<sup class="red">*</sup></label>
                        <input class="form-control" v-model="proposedPrice" id="orderProposedPrice">
                        <span class="small text-muted">Предложить свою стоимость</span><br>
                        <span class="small text-muted"><span class="red">*</span> - Стоимость без НДС</span>
                    </div>
                    <div class="form-group">
                        <label for="pendingOrderPriceComment">Комментарий к изменению цены</label>
                        <textarea class="form-control" v-model="proposedPriceComment"
                                  id="pendingOrderPriceComment"></textarea>
                    </div>
                    <div class="form-group">
                        <button class="btn btn-primary" @click="acceptOrder()"
                                :disabled="(order==null||proposedPrice==null)">
                            Принять
                        </button>
                        <button class="btn btn-default" @click="rejectOrder()" :disabled="(order==null)">Отклонить
                        </button>
                    </div>
                </div>

            </div>
        </div>
    </div>
    <div id="tab-managed-offers" class="tab-pane">
        <div class="spaced-container white container-fluid">
            <h4>Предложения от перевозчиков</h4>
            <div class="row" id="managedOffers">
                <div class="col-2">
                    <h5 th:if="${managedOffers==null || #lists.size(managedOffers) == 0}">

                        <small class="text-muted">Предложения от компаний появятся здесь</small>
                    </h5>
                    <div class="list-group">
                        <div class="input-group">
                            <input class="form-control">
                            <div class="input-group-append">
                                <span class="input-group-text"><i class="fa fa-search"></i></span>
                            </div>
                        </div>
                        <a href="#" v-bind:class="getOfferColor(managedOffer.isPriceChanged)"
                           v-for="managedOffer in managedOffers" @click="loadOfferInfo(managedOffer.id)"
                           class="list-group-item list-group-item-action grey">
                            {{ managedOffer.orderNumber}}<br>
                            <small class="text-muted">{{managedOffer.companyName }}</small>
                        </a>
                    </div>
                </div>
                <div v-if="offer" class="col-10" id="managedOfferInfo">
                    <div class="row">
                        <div class="col-12">
                            <h5>Заявка: {{offer.orderNumber}}</h5>
                            <h5>Компания: {{offer.company.name}}</h5>
                            <br>
                        </div>
                        <div class="col-8">
                            <div class="row">
                                <div class="col-4">

                                    Оплата:<br>{{offer.order.paymentType}}<br>
                                    Обязательность:<br>{{offer.order.orderObligation}}<br><br>
                                </div>
                                <div class="col-4">
                                    Дней для возврата документов:<br>
                                    {{offer.order.documentReturnDate}} <br>
                                    Дней для оплаты:<br>
                                    {{offer.order.paymentDate}}<br><br>
                                </div>
                                <div class="col-4">
                                    Водитель:<br>
                                    <span v-if="offer.driver">{{offer.driver.name}} </span>
                                    <span v-else>Не указан</span><br>
                                    Транспорт:<br><span v-if="offer.transport">{{offer.transport.number}}/{{offer.transport.type}}</span>
                                    <span v-else>Не указан</span><br><br>
                                </div>
                                <div class="col-4">
                                    Требования:
                                    <ul>
                                        <li v-for="requirement in offer.order.requirements">{{requirement}}</li>
                                    </ul>
                                </div>
                                <div class="col-4">
                                    Груз:
                                    <ul>
                                        <li v-for="cargoUnit in offer.order.cargo">{{cargoUnit}}</li>
                                    </ul>
                                </div>

                                <div class="col-4">
                                    Маршрут: {{offer.order.route.name}}<br>
                                    Пункты маршрута:
                                    <ol>
                                        <li v-for="routePoint in offer.order.route.routePoints">
                                            {{routePoint.point.name}}<br>
                                            {{routePoint.point.address}}
                                        </li>
                                    </ol>

                                </div>
                            </div>
                        </div>
                        <div class="col-4">
                            <div class="row">
                                <div v-if="offer.dispatcherPrice!=offer.proposedPrice" class="col-12">
                                    Комментарий перевозчика:<br>
                                    {{offer.proposedPriceComment}}<br><br>
                                </div>
                                <div class="col-6">
                                    Назначенная диспетчером цена:<br>
                                    {{offer.dispatcherPrice}}<br><br>
                                </div>
                                <div class="col-6">
                                    Назначенная компанией цена:<br>
                                    {{offer.proposedPrice}}<br><br>
                                </div>
                                <div class="col-12">
                                    <button class="btn btn-block btn-primary" @click="acceptOffer()"
                                            :disabled="(offer==null)">Утвердить
                                    </button>
                                    <button class="btn btn-block btn-default" @click="rejectOffer()"
                                            :disabled="(offer==null)">Отклонить
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div id="tab-sent-contracts" class="tab-pane">
        <div class="spaced-container white container-fluid">
            <h4>Контракты с перевозчиками</h4>
            <div class="row" id="sentContracts">
                <div class="col-2">
                    <h5 th:if="${contracts==null || #lists.size(contracts) == 0}">

                        <small class="text-muted">Контракты с компаниями будут выведены здесь</small>
                    </h5>
                    <div class="list-group">
                        <div class="input-group">
                            <input class="form-control">
                            <div class="input-group-append">
                                <span class="input-group-text"><i class="fa fa-search"></i></span>
                            </div>
                        </div>
                        <a href="#" v-bind:class="getOfferColor(managedOffer.isPriceChanged)"
                           v-for="managedOffer in managedOffers" @click="loadOfferInfo(managedOffer.id)"
                           class="list-group-item list-group-item-action grey">
                            {{ managedOffer.orderNumber}}<br>{{managedOffer.companyName }}
                        </a>
                    </div>
                </div>
                <div v-if="offer" class="col-10" id="managedOfferInfo">
                    <div class="row">
                        <div class="col-12">
                            <h5>Заявка: {{offer.orderNumber}}</h5>
                            <h5>Компания: {{offer.company.name}}</h5>
                            <br>
                        </div>
                        <div class="col-8">
                            <div class="row">
                                <div class="col-4">

                                    Оплата:<br>{{offer.order.paymentType}}<br>
                                    Обязательность:<br>{{offer.order.orderObligation}}<br><br>
                                </div>
                                <div class="col-4">
                                    Дней для возврата документов:<br>
                                    {{offer.order.documentReturnDate}} <br>
                                    Дней для оплаты:<br>
                                    {{offer.order.paymentDate}}<br><br>
                                </div>
                                <div class="col-4">
                                    Водитель:<br>
                                    <span v-if="offer.driver">{{offer.driver.name}} </span>
                                    <span v-else>Не указан</span><br>
                                    Транспорт:<br><span v-if="offer.transport">{{offer.transport.number}}/{{offer.transport.type}}</span>
                                    <span v-else>Не указан</span><br><br>
                                </div>
                                <div class="col-4">
                                    Требования:
                                    <ul>
                                        <li v-for="requirement in offer.order.requirements">{{requirement}}</li>
                                    </ul>
                                </div>
                                <div class="col-4">
                                    Груз:
                                    <ul>
                                        <li v-for="cargoUnit in offer.order.cargo">{{cargoUnit}}</li>
                                    </ul>
                                </div>

                                <div class="col-4">
                                    Маршрут: {{offer.order.route.name}}<br>
                                    Пункты маршрута:
                                    <ol>
                                        <li v-for="routePoint in offer.order.route.routePoints">
                                            {{routePoint.point.name}}<br>
                                            {{routePoint.point.address}}
                                        </li>
                                    </ol>

                                </div>
                            </div>
                        </div>
                        <div class="col-4">
                            <div class="row">
                                <div v-if="offer.dispatcherPrice!=offer.proposedPrice" class="col-12">
                                    Комментарий перевозчика:<br>
                                    {{offer.proposedPriceComment}}<br><br>
                                </div>
                                <div class="col-6">
                                    Назначенная диспетчером цена:<br>
                                    {{offer.dispatcherPrice}}<br><br>
                                </div>
                                <div class="col-6">
                                    Назначенная компанией цена:<br>
                                    {{offer.proposedPrice}}<br><br>
                                </div>
                                <div class="col-12">
                                    <button class="btn btn-block btn-primary" @click="acceptOffer()"
                                            :disabled="(offer==null)">Утвердить
                                    </button>
                                    <button class="btn btn-block btn-default" @click="rejectOffer()"
                                            :disabled="(offer==null)">Отклонить
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div id="tab-dispatched-offers" class="tab-pane">
        <div class="spaced-container white container-fluid">
            <h4>Высланные предложения</h4>
            <div>
                <table class="table table-striped table-sm" id="dispatchedOffersTable">
                    <thead>
                    <tr>
                        <th>id</th>
                        <th>Номер заявки</th>
                        <th>Предложенная цена</th>
                        <th>Цена от диспетчера</th>
                        <th>Водитель</th>
                        <th>Транспорт</th>
                        <th>Комментарий</th>
                    </tr>
                    </thead>
                </table>
            </div>
        </div>
    </div>
    <div id="tab-orders-in-work"
         class="tab-pane">
        <div class="spaced-container white container-fluid" style="overflow-x: scroll">
            <h4>Заявки в работе</h4>
            <div>
                <table class="table table-sm table-striped " id="ordersInWorkTable">
                    <thead>
                    <tr>
                        <th>id</th>
                        <th>Номер</th>
                        <th>Статус</th>
                        <th>Маршрут</th>
                        <th>ТК</th>
                        <th>Транспорт</th>
                        <th>Водитель</th>
                        <th>Требования</th>
                        <th>Груз</th>
                        <th>Дни для оплаты</th>
                        <th>Дни для возврата<br>документов</th>
                        <th>Рейтинг</th>
                        <th>Обязательность</th>
                        <th>Оплата</th>
                        <th>Дата исполнения</th>
                    </tr>
                    </thead>
                </table>
            </div>
        </div>
    </div>
    <div id="tab-companies" class="tab-pane">
        <div class="spaced-container white container-fluid">
            <h4>Транспортные компании</h4>
            <small class="text-muted text-sm">Зеленым подсвечены компании, созданные пользователем вашей компании
            </small>
            <div>
                <table class="table table-hover  table-striped table-sm" id="transportCompaniesTable">
                    <thead>
                    <tr>

                        <th>id</th>
                        <th>Название</th>
                        <th>Краткое название</th>
                        <th>ИНН</th>
                        <th>Кол-во ТС</th>
                        <th>ФИО гл. бухгалтера</th>
                        <th>ОКВЕД</th>
                        <th>ОКПО</th>
                        <th>ОГРН</th>
                        <th>E-mail</th>
                        <th>Налогообложение</th>
                    </tr>
                    </thead>
                </table>
            </div>
        </div>
        <div class="spaced-container white container-fluid">
            <h4>Контакты компании</h4>
            <div id="companyContactsTableWrapper" style="display: none;">
                <table class="table table-hover  table-striped" id="companyContactsTable">
                    <thead>
                    <tr>
                        <th>id</th>
                        <th>ФИО контакта</th>
                        <th>Телефон</th>
                        <th>E-mail</th>
                        <th>Должность</th>
                    </tr>
                    </thead>
                </table>
            </div>
        </div>
    </div>
    <div id="tab-routes" class="tab-pane">
        <div class=" container-fluid spaced-container white table-responsive">
            <h4>Маршруты</h4>
            <div>
                <table class="table table-hover table-striped " id="routesTable">
                    <!--<thead>-->
                    <!--<tr>-->
                    <!--<th>#</th>-->
                    <!--<th>Название</th>-->
                    <!--<th>ТК</th>-->
                    <!--<th>Ст. за маршрут</th>-->
                    <!--<th>₽/км</th>-->
                    <!--<th>₽/коробка</th>-->
                    <!--<th>₽/пункт</th>-->
                    <!--<th>₽/час</th>-->
                    <!--<th>₽/паллета</th>-->
                    <!--<th>Темп. режим</th>-->
                    <!--<th>Тип кузова</th>-->
                    <!--<th>Объем</th>-->
                    <!--<th>Тоннаж</th>-->
                    <!--<th>Погрузка</th>-->
                    <!--<th>Догруз</th>-->
                    <!--<th>Комментарий</th>-->
                    <!--</tr>-->
                    <!--</thead>-->
                </table>
            </div>
        </div>
        <div id="routesForm" style="display: flex">
            <div class="row form-group">
                <div class="col-12">
                    <div data-editor-template="name"></div>
                </div>
                <div class="col-12">
                    <div data-editor-template="company"></div>
                </div>
                <div class="col-6">
                    <div data-editor-template="totalCost"></div>
                </div>
                <div class="col-6">
                    <div data-editor-template="totalCostNds"></div>
                </div>
                <div class="col-6">
                    <div data-editor-template="costPerBox"></div>
                </div>
                <div class="col-6">
                    <div data-editor-template="costPerBoxNds"></div>
                </div>
                <div class="col-6">
                    <div data-editor-template="costPerPoint"></div>
                </div>
                <div class="col-6">
                    <div data-editor-template="costPerPointNds"></div>
                </div>
                <div class="col-6">
                    <div data-editor-template="costPerHour"></div>
                </div>
                <div class="col-6">
                    <div data-editor-template="costPerHourNds"></div>
                </div>
                <div class="col-6">
                    <div data-editor-template="costPerPallet"></div>
                </div>
                <div class="col-6">
                    <div data-editor-template="costPerPalletNds"></div>
                </div>
                <div class="col-6">
                    <div data-editor-template="costPerKilometer"></div>
                </div>
                <div class="col-6">
                    <div data-editor-template="costPerKilometerNds"></div>
                </div>
                <div class="col-12">
                    <div data-editor-template="loadingType"></div>
                </div>
                <div class="col-12">
                    <div data-editor-template="vehicleType"></div>
                </div>
                <div class="col-6">
                    <div data-editor-template="tempFrom"></div>
                </div>
                <div class="col-6">
                    <div data-editor-template="tempTo"></div>
                </div>
                <div class="col-6">
                    <div data-editor-template="volume"></div>
                </div>
                <div class="col-6">
                    <div data-editor-template="tonnage"></div>
                </div>
                <div class="col-12">
                    <div data-editor-template="afterLoad"></div>
                </div>
                <div class="col-12">
                    <div data-editor-template="comment"></div>
                </div>

            </div>

        </div>
        <div class="container-fluid spaced-container white">
            <h4>Точки маршрута</h4>
            <div>
                <table class="table table-hover  table-striped " id="routePointsTable">
                    <thead>
                    <tr>
                        <th>id</th>
                        <th>Пункт</th>
                        <th>Адрес</th>
                        <th>Клиент</th>
                        <th>Контакт</th>
                        <th>Расстояние</th>
                        <th>Стоимость ПРР</th>
                        <th>Время в пути</th>
                        <th>Время прибытия</th>
                        <th>Время разгрузки</th>
                        <th>Порядковый номер</th>
                    </tr>
                    </thead>
                </table>
            </div>
        </div>
    </div>
    <div id="tab-contacts" class="tab-pane">
        <div class=" container-fluid spaced-container white">
            <div class="row">
                <div class="col-4">
                    <h4>Клиенты</h4>
                    <div>
                        <table class="table table-hover table-striped " id="clientsTable">
                            <thead>
                            <tr>
                                <th>#</th>
                                <th>Наименование</th>
                                <th>Телефон</th>
                                <th>Контактное лицо</th>
                            </tr>
                            </thead>
                        </table>
                    </div>
                </div>
                <div class="col-8">
                    <h4>Пункты доставки</h4>
                    <div>
                        <table class="table table-hover table-striped " id="pointsTable">
                            <thead>
                            <tr>
                                <th>#</th>
                                <th>Название</th>
                                <th>Адрес</th>
                                <th>Полный адрес</th>
                                <th>Комментарий</th>
                                <th>Рабочее время</th>
                            </tr>
                            </thead>
                        </table>
                    </div>
                </div>
            </div>

        </div>
        <div class="spaced-container white container-fluid">
            <h4>Контакты</h4>
            <div>
                <table class="table table-hover  table-striped" id="contactsTable">
                    <thead>
                    <tr>
                        <th>id</th>
                        <th>Компания</th>
                        <th>ФИО</th>
                        <th>Адрес</th>
                        <th>Телефон</th>
                        <th>E-mail</th>
                        <th>Должность</th>
                    </tr>
                    </thead>
                </table>
            </div>
        </div>
    </div>
</div>
<div th:insert="fragments/header :: footer"></div>
</body>
<script sec:authorize='hasAnyAuthority("ROLE_DISPATCHER")' src="/orders/js/managed-offers.js"></script>
<script sec:authorize='hasAnyAuthority("ROLE_TRANSPORT_COMPANY")' src="/orders/js/pending-orders.js"></script>
<script sec:authorize="hasAnyAuthority('ROLE_DISPATCHER')" src="/orders/js/orders-in-work-map.js"></script>
</html>